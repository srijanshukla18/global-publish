version: '3.8'

services:
  global-publisher:
    build: .
    container_name: global-publisher
    volumes:
      - .:/app
      - ./cache:/app/cache
      - ./results:/app/results
    environment:
      - OPENAI_API_KEY=${OPENAI_API_KEY:-}
      - TWITTER_BEARER_TOKEN=${TWITTER_BEARER_TOKEN:-}
      - REDDIT_CLIENT_ID=${REDDIT_CLIENT_ID:-}
      - REDDIT_CLIENT_SECRET=${REDDIT_CLIENT_SECRET:-}
      - REDDIT_USERNAME=${REDDIT_USERNAME:-}
      - REDDIT_PASSWORD=${REDDIT_PASSWORD:-}
      - MEDIUM_TOKEN=${MEDIUM_TOKEN:-}
      - MEDIUM_USER_ID=${MEDIUM_USER_ID:-}
      - DEVTO_API_KEY=${DEVTO_API_KEY:-}
      - HN_COOKIE=${HN_COOKIE:-}
    working_dir: /app
    command: tail -f /dev/null  # Keep container running
    
  test:
    build: .
    container_name: global-publisher-test
    volumes:
      - .:/app
      - ./cache:/app/cache
    environment:
      - OPENAI_API_KEY=test-key-for-demo
    working_dir: /app
    profiles: ["test"]